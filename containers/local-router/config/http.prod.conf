# Default
server {
    listen               80;
    listen               [::]:80;
    server_name          bln.projecteats.org dashboard.bln.projecteats.org radio-middleware.bln.projecteats.org radio-server.bln.projecteats.org tv-middleware.bln.projecteats.org tv-server.bln.projecteats.org library.bln.projecteats.org;

    location / {
        add_header       Content-Type text/plain;
        return           200 'Hello World from Local Router';
    }

    location ~ /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
}

# Dashboard
server {
    server_name          dashboard.bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/dashboard.bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/dashboard.bln.projecteats.org/privkey.pem;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://dashboard:3000;
    }
}

# Radio Middleware
server {
    server_name          radio-middleware.bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/radio-middleware.bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/radio-middleware.bln.projecteats.org/privkey.pem;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://radio-middleware:3000;
    }
}

# Radio Server
server {
    server_name          radio-server.bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/radio-server.bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/radio-server.bln.projecteats.org/privkey.pem;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://radio-server:8000;
    }
}

# TV Middleware
server {
    server_name          tv-middleware.bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/tv-middleware.bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/tv-middleware.bln.projecteats.org/privkey.pem;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://tv-middleware:3000;
    }
}

# TV Server
server {
    server_name          tv-server.bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/tv-server.bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/tv-server.bln.projecteats.org/privkey.pem;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://tv-server:80;
    }
}

# Library
server {
    server_name          library.bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/library.bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/library.bln.projecteats.org/privkey.pem;
    client_max_body_size 256M;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://library:80;
    }
}

server {
    server_name          bln.projecteats.org;
    listen               443 ssl;
    ssl_certificate      /opt/nginx/ssl/live/bln.projecteats.org/fullchain.pem;
    ssl_certificate_key  /opt/nginx/ssl/live/bln.projecteats.org/privkey.pem;

    location / {
        include      /opt/nginx/includes/proxy.conf;
        proxy_pass   http://home:3000;
    }
}